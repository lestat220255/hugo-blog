<!DOCTYPE html>
<html lang="en" dir="auto">

<head>
	<meta name="generator" content="Hugo 0.133.1"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Lester&#39;s Blog</title>

<meta name="description" content="">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.ed2509306a14f8fe2e5604baba9a4691381164ba1ff1e9322be2dbff9e3c29cd.css" integrity="sha256-7SUJMGoU&#43;P4uVgS6uppGkTgRZLof8ekyK&#43;Lb/548Kc0=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://localhost:1313/index.xml">
<link rel="alternate" hreflang="en" href="http://localhost:1313/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Lester&#39;s Blog (Alt + H)">Lester&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="Home">
                    <span class="active">Home</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags" title="Tags/分类">
                    <span>Tags/分类</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/raspberrypi3b-post" title="Pi3B/树莓派3B">
                    <span>Pi3B/树莓派3B</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about" title="About/关于">
                    <span>About/关于</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">使用cloudflare加持你的网站
    </h2>
  </header>
  <div class="entry-content">
    <p>CloudFlare 简单地说，CloudFlare就是通过基于反向代理的内容分发网络（Content Delivery Network,CDN）及分布式域名解析服务（Distributed Domain Name Server），帮助受保护站点抵御包括拒绝服务攻击在内的大多数网络攻击，确保该网站长期在线，同时提升网站的性能、加载速度以改善访客体验。
作用 对于个人站来说,可以有效防御小规模DDos攻击,可以使用CloudFlare提供的免费ssl证书,可以加速网站的访问(如果是境外服务器的话,国内可以考虑用阿里云的cdn服务),且以上的服务都是免费的!
域名服务器修改步骤 注册一个CloudFlare账号后登入 点击「Add Site」,输入域名,之后一直「Next」,系统会加载当前域名的dns列表,不管它,然后复制后面出现的dns服务器地址至当前域名提供商的控制台替换掉默认的dns服务器地址即可,等待几分钟时间即出现Active,说明此时该域名已通过CloudFlare的域名服务器对访问进行解析 dns配置 跟很多域名提供商(如万网,godaddy)的dns配置面板相似,CloudFlare的dns配置不同之处在于可以在Status项切换开关颜色为「灰色」/「橙色」,灰色表示只使用CloudFlare的dns,橙色表示同时还使用cdn 如图:
ssl证书配置 在crypto选项卡中,针对ssl设置有四种模式
Off: No visitors will be able to view your site over HTTPS; they will be redirected to HTTP.
Flexible SSL: You cannot configure HTTPS support on your origin, even with a certificate that is not valid for your site. Visitors will be able to access your site over HTTPS, but connections to your origin will be made over HTTP....</p>
  </div>
  <footer class="entry-footer"><span title='2018-10-17 22:39:11.923 +0000 UTC'>October 17, 2018</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;202 words</footer>
  <a class="entry-link" aria-label="post link to 使用cloudflare加持你的网站" href="http://localhost:1313/posts/2018-10-17-%E4%BD%BF%E7%94%A8cloudflare%E5%8A%A0%E6%8C%81%E4%BD%A0%E7%9A%84%E7%BD%91%E7%AB%99/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">ssh公钥登录
    </h2>
  </header>
  <div class="entry-content">
    <p>原因 通过密码进行ssh连接存在被暴力破解的可能,但在禁用密码登录&#43;修改22端口&#43;禁用root登录之后,可以将被暴力破解的概率降到最低,且通过private_key登录服务器更适合shell操作
生成公钥,私钥 下面以ubuntu18.04为例
#( 09/27/18@11:30上午 )( lestat@lestat-MS-7A15 ):~/Desktop ssh-keygen Generating public/private rsa key pair. Enter file in which to save the key (/home/lestat/.ssh/id_rsa): /home/lestat/.ssh/vps Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /home/lestat/.ssh/vps. Your public key has been saved in /home/lestat/.ssh/vps.pub. The key fingerprint is: SHA256:rcD6QAPXaRrDfNMR1MdQu/s4TvEtOlumK3AUcdzrUaM lestat@lestat-MS-7A15 The key&#39;s randomart image is: &#43;---[RSA 2048]----&#43; | .&#43;oo*o. | | o . o ....</p>
  </div>
  <footer class="entry-footer"><span title='2018-09-27 22:39:11.923 +0000 UTC'>September 27, 2018</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;171 words</footer>
  <a class="entry-link" aria-label="post link to ssh公钥登录" href="http://localhost:1313/posts/2018-09-27-ssh%E5%85%AC%E9%92%A5%E7%99%BB%E5%BD%95/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">开始在ubuntu下工作
    </h2>
  </header>
  <div class="entry-content">
    <p>由来 家里的PC机有几个月没用了,昨天刚开机,发现SSD识别不了,经过排查,确定是盘坏了,然后只能重装
之前用的win10做开发环境,但是觉得windows还是更适合作为游戏机存在,家里又有台MBP,因此考虑到没怎么用过linux桌面版的情况,决定感受下ubuntu
分区 PC配置是12GB内存,硬盘是1T&#43;5T,1T的硬盘装数据装得差不多了,5T的还有4个T没分区,因此直接装在了5T这个盘上,200G挂载在/目录,100G挂载在/home目录,14G分到SWAP交换分区,500M分到EFI启动分区,BIOS中进行了UEFI启动配置
科学上网 linux下面的科学上网相比于windows,darwin,android,ios系统相对繁琐,首先安装好ss,开启ss后配置系统代理到ss中的本地端口
如果要实现浏览器根据GFWList规则上网,以chrome来说,需要下载一个插件:SwitchyOmega,并按照流程配置
如果要实现terminal科学上网,则需要安装proxychains
sudo apt-get install proxychains 编辑配置文件
mkdir -p /home/lestat/.proxychains/ sudo vim ~/.proxychains/proxychains.conf 如下配置(协议,ip,端口根据实际情况配置)
strict_chain proxy_dns remote_dns_subnet 224 tcp_read_time_out 15000 tcp_connect_time_out 8000 localnet 127.0.0.0/255.0.0.0 quiet_mode [ProxyList] socks5 127.0.0.1 1080 之后在需要ss的命令前加proxychains,如:
sudo proxychains git clone https://github.com/lestat220255/docker-lnmp.git docker开发环境 在安装完docker和docker-compose之后,使用我之前写的脚本,快速搭建docker&#43;nginx&#43;php&#43;mysql&#43;redis的开发环境,同时支持各种服务的多版本并存,后期开发非常方便,摆脱了集成环境的同类服务只能运行一个版本的约束
sudo proxychains git clone https://github.com/lestat220255/docker-lnmp.git cd docker-lnmp &amp;&amp; chmod u&#43;x ./init.sh &amp;&amp; ./init.sh 工具推荐 terminal扩展 proxychains git npm相关 docker相关 ntfs-3g(用于挂在windows ntfs分区的工具,如果电脑是双系统,强烈推荐) rdesktop(连接windows server) OhMyZsh tldr htop(top加强版) 社交 telegram(推荐安装一个chrome/firefox插件更方便使用) 网页版微信 科学上网 shadowsocks-qt5 proxychains(terminal) SwitchyOmega(用于浏览器上根据GFWList自动切换系统代理或是直连) 开发工具 vscode(简直不能更好用…) phpstorm(2018....</p>
  </div>
  <footer class="entry-footer"><span title='2018-09-24 22:39:11.923 +0000 UTC'>September 24, 2018</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;224 words</footer>
  <a class="entry-link" aria-label="post link to 开始在ubuntu下工作" href="http://localhost:1313/posts/2018-09-24-%E5%BC%80%E5%A7%8B%E5%9C%A8ubuntu%E4%B8%8B%E5%B7%A5%E4%BD%9C/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">docker安装php7.2记录
    </h2>
  </header>
  <div class="entry-content">
    <p>问题 准备通过Dockerfile构建php镜像,在使用docker-php-ext-install安装mcrypt扩展时遇到如下错误:
error: /usr/src/php/ext/mcrypt does not exist 原因 mycrypt extension is not provided with the PHP source since 7.2 , but are instead available through PECL. To install a PECL extension in docker, use pecl install to download and compile it, then use docker-php-ext-enable to enable it:
php从7.2开始不再在源码里支持mcrypt扩展而转到pecl方式支持
pecl install mcrypt-1.0.1 docker-php-ext-enable mcrypt 解决 版本切换到7.1再执行构建时问题没有复现,同时按照
pecl install mcrypt-1.0.1 docker-php-ext-enable mcrypt 的方式安装之后也没有出现上述问题
问题 安装过程中提示(虽然不会影响最终结果)
WARNING: Ignoring APKINDEX.e3d33561.tar.gz: No such file or directory 解决 doing apk update fixes the problem (updates the index)....</p>
  </div>
  <footer class="entry-footer"><span title='2018-09-21 22:39:11.923 +0000 UTC'>September 21, 2018</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;310 words</footer>
  <a class="entry-link" aria-label="post link to docker安装php7.2记录" href="http://localhost:1313/posts/2018-09-21-docker%E5%AE%89%E8%A3%85php7.2%E8%AE%B0%E5%BD%95/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">北海三日游
    </h2>
  </header>
  <div class="entry-content">
    <p>比较有特色的一座滨海城市,当地的人也很友好,少了一些浮躁
</p>
  </div>
  <footer class="entry-footer"><span title='2018-08-15 22:39:11.923 +0000 UTC'>August 15, 2018</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;2 words</footer>
  <a class="entry-link" aria-label="post link to 北海三日游" href="http://localhost:1313/posts/2018-08-15-%E5%8C%97%E6%B5%B7%E4%B8%89%E6%97%A5%E6%B8%B8/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">webview调用小程序支付流程
    </h2>
  </header>
  <div class="entry-content">
    <p>最近在做一个叫资源树的小型商城项目,其中有一个场景需要在小程序中嵌入的web-view内向小程序发起支付请求完成支付,折腾了一天,在网上各种经验的帮助下总算搞定了,现在记录一下流程
环境&amp;技术栈 采用前后端分离的开发模式
接口请求协议:https&#43;http(https为了兼顾小程序) 后端:lnmp
前端:vue-cli&#43;element-ui开发的spa(路由模式为history)
小程序:pages/index/index.js(默认入口文件,用于获取openid并跳转),webview页面(嵌套了spa),wxpay页面(发起小程序支付),webvieworders页面(支付成功后跳转)
步骤 index.js在onload里使用wx.login获取到code参数,并携带该参数向后台服务器请求openid 携带后台返回的openid通过小程序路由跳转至webview页面，webview页面的js在onload里通过options参数获取到携带的openid后通过webview发送至spa应用中 spa入口接收到openid后保存至cookie 在支付页面获取该openid并向后台(调用微信统一下单接口并返回后续wxpayment方法所需参数的地址)发起请求，拿到服务器返回的jsParameters后携带该参数通过小程序提供的wx.miniProgram.navigateTo方法跳转回小程序支付页面(逻辑自己写)，支付页面接收到该参数后解析成js对象并在请求小程序支付方法中携带该参数 处理支付成功或失败逻辑即可 已完成初步测试以及小程序上线</p>
  </div>
  <footer class="entry-footer"><span title='2018-08-09 22:39:11.923 +0000 UTC'>August 9, 2018</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;14 words</footer>
  <a class="entry-link" aria-label="post link to webview调用小程序支付流程" href="http://localhost:1313/posts/2018-08-09-webview%E8%B0%83%E7%94%A8%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%94%AF%E4%BB%98%E6%B5%81%E7%A8%8B/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">使用vps一年来的收获
    </h2>
  </header>
  <div class="entry-content">
    <p>我的vps于2017-08-22购买于vultr,当时的目的很简单:搭建一个ssserver用于科学上网，以及搭建自己的站点/博客
通过google(当时用的老D的host),前一个目标很快就完成了,而后面那个也通过不断尝试,最后通过编译安装完成了lnmp环境搭建
之后在工作之余都会去学一些自己觉得有意思的东西,比如workerman,docker,gitlab,jenkins,python,scrapy,nginx等等
对于shell命令也熟练了很多,后续在公司的项目里搭建简单的生产环境也可以在短时间内完成
vultr的服务器是按时间计费,我买的是$5一个月的1核,1G,25GB SSD,流量1T/月的配置,加上.me域名的费用,一年大概500多一点,很是划算!</p>
  </div>
  <footer class="entry-footer"><span title='2018-07-19 22:39:11.923 +0000 UTC'>July 19, 2018</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;6 words</footer>
  <a class="entry-link" aria-label="post link to 使用vps一年来的收获" href="http://localhost:1313/posts/2018-07-19-%E4%BD%BF%E7%94%A8vps%E4%B8%80%E5%B9%B4%E6%9D%A5%E7%9A%84%E6%94%B6%E8%8E%B7/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">欢迎来我的新博客
    </h2>
  </header>
  <div class="entry-content">
    <p>“Migration Complete!”
博客迁移 今天把博客从hexo迁移到了jekyll,感觉文章发布上jekyll比hexo更方便,而且我喜欢这个主题~
我的旧博客
—— Lestat 于 2018.07.05</p>
  </div>
  <footer class="entry-footer"><span title='2018-07-05 22:39:11.923 +0000 UTC'>July 5, 2018</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;9 words</footer>
  <a class="entry-link" aria-label="post link to 欢迎来我的新博客" href="http://localhost:1313/posts/2018-07-05-%E6%AC%A2%E8%BF%8E%E6%9D%A5%E6%88%91%E7%9A%84%E6%96%B0%E5%8D%9A%E5%AE%A2/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">同一页面巧妙使用多个element-ui的upload组件
    </h2>
  </header>
  <div class="entry-content">
    <p>问题 最近在使用SSR(服务器端渲染)方式引入vue&#43;element-ui开发一个商城项目的时候遇到一个问题:因为商城的订单是可能包含多个商品,所以订单的评价涉及到同一个页面多组表单的异步提交(每一组表单包含评价内容和上传的多张图片)
由于element-ui的upload组件默认没有提供多个组件在同一页面绑定不同模型的接口,因此在网上搜了一下,搜到了这篇文章,文章中最后的建议是自己封装一个组件来调用upload组件,使用的时候直接调用自己封装的这个组件,但是项目时间紧迫,我这边希望更快的搞定这个问题,于是想到了以下办法
解决方法 在upload组件的接口中,有一个data接口,可以绑定需要上传的除文件之外的其他数据对象,由于订单评价页的一个特点:每个商品不论数量大小都只会被评价一次,因此此处直接将当前数组中商品的uuid绑定到data并传递至上传接口,此操作后表单提交的payload就会包含类似如下数据:
Content-Disposition: form-data; name=&#34;uuid&#34; E7D947BA-79F1-11E8-B786-00163E063020 而后台文件上传位置可以做一个判断:如果接收的上传请求包含额外参数,则全部原路返回,因此在上传成功后又会在on-success这个钩子接收到这个唯一的uuid,此处对当前页面商品数组进行遍历并进行比对,在包含返回的uuid对应数组的对应保存组图路径的数组push当前上传成功的图片路径
this.data.goods_list.forEach((e,k)=&gt;{ if(e.uuid === response.uuid){ e.evaluate.thumbs.push(response.url) } }) 以下是完整代码(html):
&lt;div class=&#34;userEva-cont&#34; v-for=&#34;(item,key) in data.goods_list&#34;&gt; &lt;table class=&#34;userEva-table&#34;&gt; &lt;thead&gt; &lt;tr&gt; &lt;th width=&#34;420&#34;&gt;商品&lt;/th&gt; &lt;th width=&#34;280&#34;&gt;型号&lt;/th&gt; &lt;th width=&#34;280&#34;&gt;数量&lt;/th&gt; &lt;/tr&gt; &lt;/thead&gt; &lt;tbody&gt; &lt;tr&gt; &lt;td&gt; &lt;div class=&#34;evaluate-pic&#34;&gt;&lt;a :href=&#34;&#39;/product/&#39;&#43;item.goods_id&#43;&#39;.html&#39;&#34;&gt;&lt;img :src=&#34;&#39;__PHOTO__&#39;&#43;item.thumb&#34;&gt;&lt;/a&gt;&lt;/div&gt; &lt;div class=&#34;evaluate-text&#34;&gt; &lt;h3&gt;&lt;a&gt;{{item.goods_name}}&lt;/a&gt;&lt;/h3&gt; &lt;p&gt;编号：{{item.uuid}}&lt;/p&gt; &lt;/div&gt; &lt;/td&gt; &lt;td&gt;型号：{{item.goods_specification_name}}&lt;/td&gt; &lt;td&gt;{{item.num}}&lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/table&gt; &lt;div class=&#34;evaluate-wrap&#34;&gt; &lt;form&gt; &lt;dl&gt; &lt;dt&gt;评论：&lt;/dt&gt; &lt;dd&gt; &lt;textarea v-model=&#34;item.evaluate.content&#34; placeholder=&#34;评论内容&#34;&gt;&lt;/textarea&gt; &lt;/dd&gt; &lt;/dl&gt; &lt;dl&gt; &lt;dt&gt;晒单：&lt;/dt&gt; &lt;dd&gt; &lt;el-upload class=&#34;upload-demo&#34; :action=&#34;basePath&#34; :on-preview=&#34;handlePreview&#34; :on-remove=&#34;handleRemove&#34; drag multiple :data=&#34;item&#34; :limit=&#34;5&#34; :on-success=&#34;setFileList&#34; list-type=&#34;picture&#34;&gt; &lt;i class=&#34;el-icon-upload&#34;&gt;&lt;/i&gt; &lt;div class=&#34;el-upload__text&#34;&gt;将文件拖到此处，或&lt;em&gt;点击上传&lt;/em&gt;&lt;/div&gt; &lt;div class=&#34;el-upload__tip&#34; slot=&#34;tip&#34;&gt;只能上传jpg/png文件，且不超过500kb&lt;/div&gt; &lt;/el-upload&gt; &lt;/dd&gt; &lt;/dl&gt; &lt;div class=&#34;evaluate-btns&#34;&gt; &lt;button type=&#34;button&#34; class=&#34;evaluate-sub&#34; @click=&#34;submit(item....</p>
  </div>
  <footer class="entry-footer"><span title='2018-06-30 22:39:11.923 +0000 UTC'>June 30, 2018</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;230 words</footer>
  <a class="entry-link" aria-label="post link to 同一页面巧妙使用多个element-ui的upload组件" href="http://localhost:1313/posts/2018-06-30-%E5%90%8C%E4%B8%80%E9%A1%B5%E9%9D%A2%E5%B7%A7%E5%A6%99%E4%BD%BF%E7%94%A8%E5%A4%9A%E4%B8%AAelement-ui%E7%9A%84upload%E7%BB%84%E4%BB%B6/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">gitlab出现forbidden的解决方法
    </h2>
  </header>
  <div class="entry-content">
    <p>问题 前些天在公司的测试服务器上基于docker安装了gitlab,今天同事突然反映gitlab地址访问的时候页面提示Forbidden,http状态码也是对应的403,于是google一下,发现原因可能是较多的并发导致的访问被拒绝
原因 Gitlab使用rack_attack做了并发访问的限制
解决方法 配置/etc/gitlab/gitlab.rb文件,服务器当前使用的docker,对应目录是/home/gitlab/config/gitlab.rb(该目录/文件根据docker容器创建时指定的目录/文件映射关系决定)
找到下面这段配置
gitlab_rails[&#39;rack_attack_git_basic_auth&#39;] = { &#39;enabled&#39; =&gt; true, &#39;ip_whitelist&#39; =&gt; [&#34;127.0.0.1&#34;, &#34;服务器公网ip&#34;], &#39;maxretry&#39; =&gt; 10, &#39;findtime&#39; =&gt; 60, &#39;bantime&#39; =&gt; 3600 } 去掉注释,然后改为
gitlab_rails[&#39;rack_attack_git_basic_auth&#39;] = { &#39;enabled&#39; =&gt; true, &#39;ip_whitelist&#39; =&gt; [&#34;127.0.0.1&#34;, &#34;服务器公网ip&#34;], &#39;maxretry&#39; =&gt; 100, &#39;findtime&#39; =&gt; 60, &#39;bantime&#39; =&gt; 60 } 保存退出
运行docker exec 容器名称 gitlab-ctl reconfigure 至此,上述问题解决
参考链接:GitLab issuing temporary IP bans - 403 forbidden</p>
  </div>
  <footer class="entry-footer"><span title='2018-06-06 22:39:11.923 +0000 UTC'>June 6, 2018</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;63 words</footer>
  <a class="entry-link" aria-label="post link to gitlab出现forbidden的解决方法" href="http://localhost:1313/posts/2018-06-06-gitlab%E5%87%BA%E7%8E%B0forbidden%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="http://localhost:1313/page/2/">
      «&nbsp;Prev&nbsp;
    </a>
    <a class="next" href="http://localhost:1313/page/4/">Next&nbsp;&nbsp;»
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="http://localhost:1313/">Lester&#39;s Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
