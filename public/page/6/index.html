<!doctype html><html lang=en dir=auto><head><meta name=generator content="Hugo 0.111.3"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Lester's Blog</title><meta name=description content><meta name=author content><link rel=canonical href=https://blog.88886688.xyz/><link crossorigin=anonymous href=/assets/css/stylesheet.84a638ec294a2a547ea8ea3f2466d240b38b987cbbb815b534c0442ed8d517d7.css integrity="sha256-hKY47ClKKlR+qOo/JGbSQLOLmHy7uBW1NMBELtjVF9c=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.88886688.xyz/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.88886688.xyz/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.88886688.xyz/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.88886688.xyz/apple-touch-icon.png><link rel=mask-icon href=https://blog.88886688.xyz/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://blog.88886688.xyz/index.xml><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Lester's Blog"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://blog.88886688.xyz/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Lester's Blog"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"Lester's Blog","url":"https://blog.88886688.xyz/","description":"","thumbnailUrl":"https://blog.88886688.xyz/favicon.ico","sameAs":[]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.88886688.xyz/ accesskey=h title="Lester's Blog (Alt + H)">Lester's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.88886688.xyz/ title="Lester's Blog"><span class=active>Home</span></a></li><li><a href=https://blog.88886688.xyz/tags/ title=Tags><span>Tags/分类</span></a></li><li><a href=https://blog.88886688.xyz/about/ title="About Me"><span>About/关于</span></a></li></ul></nav></header><main class=main><article class=post-entry><header class=entry-header><h2>tp3.2.3实现支持点击排序</h2></header><div class=entry-content><p>假设:
Admin/Home/Controller/BaseController.class.php是一个基础控制器 $current_params和$in是两个在Admin/Home/Controller/BaseController.class.php中用来保存接收参数的属性,并且已经在构造函数中对其赋值 Admin/Tpl/Index/footer.html是布局中的公共部分 Public/Model/BaseModel.class.php是公共模型 请求中用来表示模块,控制器,操作的参数名称分别为:m,c,a #searchForm和#excelForm分别为条件搜索form和excel表单导出请求提交时用来临时保存和传递筛选条件的form 全局改动 Admin/Home/Controller/BaseController.class.php改动: 新增protected $current_params属性
_initialize方法尾部新增以下代码(用于处理传入的有效参数):
unset($this->current_params['m']); unset($this->current_params['c']); unset($this->current_params['a']); $this->assign('page_url', U(CONTROLLER_NAME.'/'.ACTION_NAME,$this->current_params)); 控制器尾部新增以下方法:
/* * todo:处理排序请求 * @param $sort string 用来mysql排序的字符串 * @param $column string 用来指定排序字段名称 * @param $value int 排序值,1:顺序;2:倒序 * @param $table string 需要排序字段在当前sql语句中表的别名 * @return string 返回处理后的$order * */ protected function assembleSort($sort,$column,$value,$table){ $order = urldecode($sort); $v_sort[$column] = $value == 1 ? 2 : 1; $v_sort['param_sort'] = $sort; $v_sort['param_column'] = $column; $v_sort['param_value'] = $v_sort[$column]; $v_sort['param_table'] = $table; $this->assign('sort', $v_sort); return $order; } Admin/Tpl/Index/footer....</p></div><footer class=entry-footer><span title='2017-09-14 22:39:11.923 +0000 UTC'>September 14, 2017</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;338 words</footer><a class=entry-link aria-label="post link to tp3.2.3实现支持点击排序" href=https://blog.88886688.xyz/posts/2017-09-14-thinkphp%E5%AE%9E%E7%8E%B0%E7%82%B9%E5%87%BB%E6%8E%92%E5%BA%8F/></a></article><article class=post-entry><header class=entry-header><h2>mysql开发规范</h2></header><div class=entry-content><p>命名规范 库名、表名、字段名必须使用小写字母，并采用下划线分割 库名、表名、字段名禁用超过32个字符。须见名知意 库名、表名、字段名禁用使 MySQL保留字 临时库、表名必须以tmp为前缀，并以日期为后缀 备份库、表必须以bak为前缀，并以日期为后缀 基础规范 使用INNODB存储引擎 表字符集使用utf8mb4 所有表都需要添加注释 单表数据量建议控制在5000W以内 不在数据库中存储图片、文件等大数据 禁止在线上做数据库压力测试 禁止从测试、开发环境直连数据库 库表设计 禁止使用分区表 拆分大字段和访问频率低的字段，分离冷热数据 HASH进行散表，表名后缀使用十进制数，下标从0开始 按日期时间分表需符合YYYY[MM][DD][HH]格式 采用合适的分库分表策略。例如千库十表、十库百表等 字段设计 尽可能不使用TEXT、BLOB类型 DECIMAL代替FLOAT和DOUBLE存储精确浮点数 Simple is good 将字符转化为数字 使用TINYINT来代替ENUM类型 Generosity can be unwise 存储 “hello”时VARCHAR(5) VS VARCHAR(200) Avoid null if possible 所有字段均定义为NOT NULL ! Smaller is usually better 使用UNSIGNED存储非负整数 INT类型固定占用4字节存储 使用timestamp存储时间 使用INT UNSIGNED存储IPV4 使用VARBINARY存储大写敏感的变 字符串 禁用在数据库中存储明文密码 索引规范 索引的用途 去重 加速定位 避免排序 覆盖索引 索引数量控制 单张表中索引数量不超过5个 单个索引中的字段数不超过5个 对字符串使用前缀索引，前缀索引长度不超过8个字符 建议优先考虑前缀索引，必要时可添加伪列并建立索引 主键准则 表必须有主键 不使用更新频繁的列 尽量不选择字符串列 不使用UUID MD5 HASH 默认使用非空的唯一键 建议选择自增或发号器 重要的SQL必须被索引 UPDATE、DELETE语句的WHERE条件列 ORDER BY、GROUP BY、DISTINCT的字段 多表JOIN的字段 区分度最大的字段放在前 核心SQL优先考虑覆盖索引 避免冗余和重复索引 索引不是越多越好 综合评估数据密度和分布 考虑查询和更新比例</p></div><footer class=entry-footer><span title='2017-09-12 22:39:11.923 +0000 UTC'>September 12, 2017</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;88 words</footer><a class=entry-link aria-label="post link to mysql开发规范" href=https://blog.88886688.xyz/posts/2017-09-12-mysql%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/></a></article><article class=post-entry><header class=entry-header><h2>apache2开启SSL</h2></header><div class=entry-content><p>windows+apache2开启SSL以及80端口强制跳转SSL访问的方法
申请证书 推荐Let’s Encrypt(免费证书的有效期为3个月,但提供了自动更新证书的功能),也可以用阿里云(免费证书有效期1年,目前是手动更新)
开启ssl模块 首先确保apache开启了LoadModule ssl_module modules/mod_ssl.so
配置443端口 再参考官方文档的一段内容:
Listen 443 &lt;VirtualHost *:443> DocumentRoot "项目入口文件目录" ServerName 域名 SSLEngine on SSLCertificateFile "路径/文件名.cert" SSLCertificateKeyFile "路径/文件名.key" &lt;/VirtualHost> 在apache的vhosts.conf中添加以上代码,重启apache
配置80端口跳转443 这里直接上代码:
&lt;VirtualHost *:80> RewriteEngine on RewriteCond %{SERVER_PORT} !^443$ RewriteRule ^/?(.*)$ https://%{SERVER_NAME}%{REQUEST_URI} [L,R] ServerName 域名 &lt;/VirtualHost> 告诉apache将该域名下80端口的所有请求跳转到443,重启apache
至此配置完成 在ubuntu环境下配置基本一样,开启apache ssl模块支持使用sudo a2enmod ssl,然后重启service apache2 restart
补充:
后面在一个微信项目中发现以上做法的一个问题:
安卓手机在使用微信内置浏览器QQ浏览器X5内核提供技术支持访问可能会出现页面空白的情况,而在PC端的调试工具和IOS以及其他浏览器上未发现该问题
解决方法:修改虚拟机配置如下:
Listen 443 &lt;VirtualHost *:443> DocumentRoot "项目入口文件目录" ServerName 域名 SSLEngine on SSLCertificateFile "路径/文件名.cert" SSLCertificateKeyFile "路径/文件名.key" SSLCertificateChainFile "路径/文件名....</p></div><footer class=entry-footer><span title='2017-09-08 22:39:11.923 +0000 UTC'>September 8, 2017</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;72 words</footer><a class=entry-link aria-label="post link to apache2开启SSL" href=https://blog.88886688.xyz/posts/2017-09-08-apache2-ssl/></a></article><article class=post-entry><header class=entry-header><h2>油猴的简单使用</h2></header><div class=entry-content><p>关于greasemonkey(油猴)的安装和一些实用脚本推荐
步骤 准备工作:确保你的电脑可以科学上网 以本人的chrome浏览器为例
1. 打开一个新标签页 2. 地址栏输入chrome://apps/ 3. 页面右下角选择网上应用店 4. 搜索greasemonkey,如图: 5. 点击安装,完成安装后在如图位置会出现一个图标 6. 点击获取新脚本跳转到一个页面,在当前页面中点击途中位置 7. 会跳转到Greasy Fork的搜索页,在搜索框中输入userscript+点击enter 8. 在出现的结果中选择 其他 greasemonkey(油猴子介绍) 简单说是一个可以安装当前正在浏览页面可用的额外功能的脚本,举个栗子:非会员在优酷视频无法观看会员视频,而安装油猴子之后再安装了userscript+脚本就可以自动在当前页面检测可用的脚本(可用脚本的提示将会出现在页面右下角,点击即安装)
介绍一下VIP视频破解脚本用法 用优酷举例吧,直接上图
1. 首页点击会员 2. 随便选择一个视频 3. 视频播放窗口左上角可以切换通道(部分通道可能无法播放,不过选择超多) 本文仅供心得交流,请自觉购买会员支持正版! 关于科学上网请自行baidu</p></div><footer class=entry-footer><span title='2017-09-05 22:39:11.923 +0000 UTC'>September 5, 2017</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;34 words</footer><a class=entry-link aria-label="post link to 油猴的简单使用" href=https://blog.88886688.xyz/posts/2017-09-05-grease-monkey/></a></article><footer class=page-footer><nav class=pagination><a href=https://blog.88886688.xyz/>«&nbsp;First&nbsp;</a>
&nbsp;
<a class=prev href=https://blog.88886688.xyz/page/5/>«&nbsp;Prev&nbsp;</a></nav></footer></main><footer class=footer><span>&copy; 2017-2023 <a href=https://blog.88886688.xyz/>Lester's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span><br><span>Email: <a href=mailto:lestat9527@gmail.com>lestat9527@gmail.com</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>